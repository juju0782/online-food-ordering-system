{% extends 'layout.html' %}

{% block main %}
<style>
/* Styles */
.hero-section {
    height: 80vh;
    background: linear-gradient(135deg, #5a9bd5, #a2d8f0);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: white;
    text-align: center;
    position: relative;
    padding: 20px;
}
.hero-section .wave {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 150px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' ...") no-repeat center;
    background-size: cover;
}
.search-form {
    margin-top: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}
.search-form input {
    width: 300px;
    max-width: 80%;
    padding: 10px;
    border-radius: 25px;
    border: none;
    outline: none;
}
.search-form button {
    padding: 10px 20px;
    border-radius: 25px;
    border: none;
    background-color: #004085;
    color: #fff;
    font-weight: bold;
}
.search-form button:hover {
    background-color: #0056b3;
}
body {
    background-color: #f8f9fa;
    scroll-behavior: smooth;
}
.menu-container {
    max-width: 1050px;
    margin: 50px auto;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
}
.category {
    margin-bottom: 20px;
    display: none;
}
.category h3 {
    background: #007bff;
    color: #fff;
    padding: 10px;
    border-radius: 3px;
}
.food-item {
    padding: 5px;
    border-bottom: 1px solid #ddd;
}
.nav-categories {
    text-align: center;
    margin-bottom: 20px;
}
.nav-categories a {
    padding: 2px;
    margin: 20px auto;
    width: 80%;
    border-radius: 10px;
    color: #007bff;
    font-weight: bold;
    text-decoration: none;
    cursor: pointer;
}
.nav-categories a:hover {
    text-decoration: underline;
}
</style>

<!-- Hero Section -->
<div class="container-fluid py-0">
    <div class="hero-section">
        <div class="text-center">
            <h1 class="display-4 font-weight-bold">Welcome to <span>{{ company_name|title }}</span></h1>
            <p class="lead">Explore the best products, curated for your needs.</p>
            <form class="search-form justify-content-center" action="/search" method="GET">
                <input type="text" name="query" placeholder="Search for products..." aria-label="Search" />
                <button type="submit">Search</button>
            </form>
            <a href="{{ url_for('main.client_transaction_history') }}">My Transactions</a> |
            <a href="{{ url_for('main.download_my_transactions') }}" class="btn btn-outline-primary">Download PDF</a>
        </div>
        <div class="wave"></div>
    </div>
</div>

<!-- Categories Navigation -->
<div class="container menu-container py-5">
    <h2 class="text-center">All Categories</h2>
    <div class="nav-categories py-2">
        <a onclick="showCategory('beverages')">Beverages</a>
        <a onclick="showCategory('seafood')">Seafood</a>
        <a onclick="showCategory('salad')">Salad</a>
        <a onclick="showCategory('breakfast')">Breakfast</a>
        <a onclick="showCategory('kids-meal')">Kids meal</a>
        <a onclick="showCategory('street-food')">Street food</a>
        <a onclick="showCategory('appetizer')">Appetizer</a>
        <a onclick="showCategory('snacks')">Snacks</a>
        <a onclick="showCategory('desserts')">Desserts</a>
    </div>

    <!-- Category Sections here... your static links -->

    <!-- Products Section -->
    <div class="container py-5">
        <h2 class="mb-4">Our Products</h2>
        <div class="row row-cols-2 row-cols-md-4 g-3">
            {% for product in products %}
            <div class="col">
                <div class="card h-100">
                    <img 
                        src="{{ product.product_image_path }}" 
                        class="card-img-top" 
                        alt="{{ product.product_name }}" 
                        style="height: 200px; object-fit: contain;">
                    <div class="card-body">
                        <h5 class="card-title">{{ product.product_name }}</h5>
                        <p class="card-text text-truncate">{{ product.product_description }}</p>
                        <p class="card-text"><strong>Price:</strong> KES {{ product.price }}</p>
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <a href="{{ url_for('main.product_detail', product_id=product.product_id) }}" class="btn btn-outline-primary">View More</a>
                            <button 
                                class="btn btn-primary add-to-cart" 
                                data-product-id="{{ product.product_id }}" 
                                data-action="increment">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Scripts -->
<script>
function showCategory(categoryId) {
    document.querySelectorAll('.category').forEach(category => {
        category.style.display = 'none';
    });
    document.getElementById(categoryId).style.display = 'block';
}
document.addEventListener('DOMContentLoaded', function() {
    const addToCartButtons = document.querySelectorAll('.add-to-cart');
    addToCartButtons.forEach(button => {
        button.addEventListener('click', function(event) {
            event.preventDefault();
            const productId = this.getAttribute('data-product-id');
            const action = this.getAttribute('data-action');
            fetch('/cart/shopping-cart', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ product_id: productId, action: action })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(data.message || "Item added to the cart!");
                    location.reload();
                } else {
                    alert(data.message || "Failed to update cart.");
                }
            })
            .catch(error => {
                console.error(error);
                alert("An error occurred while updating the cart.");
            });
        });
    });
});
</script>
{% endblock %}
